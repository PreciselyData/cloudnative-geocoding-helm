###################################################################
## CONFIG | Geo-Addressing Application | Regional Addressing Service
###################################################################

enabled: true
## The number of regional-addressing pods to run
replicaCount: 1

## Configuration for the regional-addressing-service container image.
##
## - Please visit the official 'Precisely Data Experience' website to download container images:
##   https://data.precisely.com/products
image:
  repository: regional-addressing-service
  pullPolicy: Always
  tag: 1.0.1
imagePullSecrets: [ ]

## This will override the name of the installed regional-addressing deployment.
nameOverride: "regional-addressing"
fullnameOverride: "regional-addressing"

## A service account will be created by default.
serviceAccount:
  create: true
  annotations: { }
  name: ""

## podAnnotations for regional-addressing deployments
podAnnotations: { }

podLabels: {}

## The security context for the regional-addressing Pods
## - spec for PodSecurityContext:
##   https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#podsecuritycontext-v1-core
##
podSecurityContext: { }
securityContext: { }

## Configs for the service of the regional-addressing deployment
service:
  type: ClusterIP
  port: 80


###################################
## CONFIG | Kubernetes Ingress
###################################
ingress:
  ## By default, ingress is enabled for regional-addressing service
  enabled: true
  ## The Ingress Class for the web Ingress
  ## - [WARNING] requires Kubernetes 1.18 or later, use "kubernetes.io/ingress.class" annotation for older versions
  className: "nginx"
  ## Annotations for the Ingress
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
    nginx.ingress.kubernetes.io/rewrite-target: /$1
  hosts:
    ## The host for the Ingress
    ## [WARNING] Do NOT provide regex while providing path, it's already handled in the ingress.yaml
    ## ____ EXAMPLE _______________
    ##   # webserver URL: geoaddressing.precisely.com
    ##   # path: "/precisely/addressing"
    ##
    - host: geoaddressing.precisely.com
      paths:
        - path: /precisely/addressing
          pathType: ImplementationSpecific
  tls: [ ]

## Resource requests/limits for the regional-addressing pods
## - spec for ResourceRequirements:
##   https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#resourcerequirements-v1-core
##
## The default recommended resources requests for regional-addressing service is:
##    requests:
##      cpu: 1
##      memory: 2Gi
resources:
  requests:
    cpu: 1
    memory: 2Gi
  limits:
    memory: 2Gi

## Configurations for the HorizontalPodAutoscaler of the regional-addressing pods
##
## [WARNING]: To ensure efficient operation of the HorizontalPodAutoscaler, you must have the Metrics API server
## installed in your Kubernetes Cluster.
##
## To install the Metrics API server, please use the following command:
## `kubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml`
##
## For the regional-addressing service, autoscaling is enabled by default to handle large workloads.
autoscaling:
  enabled: true
  minReplicas: 3
  maxReplicas: 20
  targetCPUUtilizationPercentage: 60

## The toleration configs for the regional-addressing pods
## - spec for Toleration:
##   https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#toleration-v1-core
##
tolerations: [ ]

## the affinity configs for the regional-addressing pods
## - spec for Affinity:
##   https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#affinity-v1-core
##
affinity: { }

## addressing-hook is used to identify the latest vintage of reference data to mount to the addressing containers.
## In case, if you want to provide a specific reference data vintage, use the `global.manualDataConfig` parameters and disable addressing-hook.
addressing-hook:
## Config for enabling or disabling `data-vintage` job hook.
  enabled: true

################################################
## CONFIG | Autocomplete Express Functionalities
################################################
##
## config related to addressing-express helm chart.
## This helm chart is required if you want to enable addressing express capabilities in your addressing infrastructure.
## This service is needed for enabling Geocoding without country.
addressing-express:
  ## number of replicas for addressing-express pods.
  replicaCount: 1
  imagePullSecrets: [ ]
  ## service account will be created by default for addressing-express deployment.
  serviceAccount:
    create: true
    annotations: { }
    name: ""
  ## pod annotations for addressing-express pods
  podAnnotations: { }
  ## the security context for the addressing-express Pods
  ## - spec for PodSecurityContext:
  ##   https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#podsecuritycontext-v1-core
  ##
  podSecurityContext: { }
  securityContext: { }
  ## the toleration configs for the addressing-express pods
  ## - spec for Toleration:
  ##   https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#toleration-v1-core
  ##
  tolerations: [ ]
  ## the affinity configs for the autocomplete pods
  ## - spec for Affinity:
  ##    https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#affinity-v1-core
  ##
  affinity: { }
  ##
  ## Autoscaling configs
  ## By default, minimum replicas are set to 1 and maximum to 10
  ## You can override this parameter as follows:
  # --set "addressing-express.autoscaling.minReplicas=10"
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 20
    targetCPUUtilizationPercentage: 50
  
  resources:
    requests:
      cpu: 2
      memory: 4Gi

  ###########################################
  ## CONFIG | Express Engine Data Restore Job
  ## Use this job to allow loading the data
  ## for addressing-express service
  ###########################################
  expressEngineDataRestore:
    ##
    ## The nodeSelector configs for the express-engine-data-restore job
    ## - docs for nodeSelector:
    ##   https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector
    ##
    ## Note: This should be a arm based cluster node group
    nodeSelector: { }

    ##
    ## Flag to allow reload of express engine data
    ## Note: This will delete all existing data from the cluster and reload it
    allowDataReload: false

    ##
    ## Manual data vintage configuration for express engine data
    ## Note: Manual data vintage configuration overrides the automatic data vintage configuration
    dataConfig:
      # expressConfig.json: |
      #   {
      #     "nzl": {
      #         "addressing": {
      #             "path": {{printf "%s/%s/%s" .Values.global.nfs.expressEngineDataMountPath .Values.global.nfs.expressEngineBasePath "addressing/nzl/202312" | quote}},
      #             "vintage": "202312"
      #         }
      #     },
      #     "usa": {
      #         "addressing": {
      #             "path": {{printf "%s/%s/%s" .Values.global.nfs.expressEngineDataMountPath .Values.global.nfs.expressEngineBasePath "addressing/usa/202309" | quote}},
      #             "vintage": "202309"
      #         }
      #     }
      #   }

  expressenginedata:
    
    autoscaling:
      ## Keep this enabled
      enabled: true
      ##
      ## Warning: Do not reduce the count of minReplicas on helm upgrade. This will lead to data loss
      ##
      minReplicas: 3
      maxReplicas: 20

      targetCPUUtilizationPercentage: 50

    ##
    ## The nodeSelector configs for the express-engine-data service
    ## - docs for nodeSelector:
    ##   https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector
    ##
    ## Note: This should be a arm based cluster node group
    nodeSelector: {}

    ##
    ## Should be 50% of the memory
    ##
    expressEngineJavaOpts: "-Xmx16G -Xms16G"
    
    ##
    ## This is the minimum resources required
    ##
    resources:
      requests:
        cpu: 16
        memory: 32Gi

  expressenginemaster:
    
    ##
    ## Warning: Do not reduce the count of replicas on helm upgrade. This will lead to data loss
    ##
    replicas: 3

    ##
    ## The nodeSelector configs for the express-engine-master service
    ## - docs for nodeSelector:
    ##   https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector
    ##
    ## Note: This should be a arm based cluster node group
    nodeSelector: {}

    ##
    ## Should be 50% of the memory
    ##
    expressEngineJavaOpts: "-Xmx3G -Xms3G"

    ##
    ## This is the minimum resources required
    ##
    resources:
      requests:
        cpu: 2
        memory: 6Gi
      limits:
        cpu: 4
        memory: 6Gi


###################################
## CONFIG | Addressing Functionalities
###################################
##
## Configurations related to addressing-svc helm chart.
## This helm chart is required if you want to enable verify-geocode capabilities in your addressing infrastructure.
addressing-svc:
  ## Config for enabling or disabling `verify-geocode` capabilities.
  enabled: true
  ## Number of replicas for addressing pods.
  replicaCount: 1
  imagePullSecrets: [ ]
  ## Service account will be created by default for addressing deployment.
  serviceAccount:
    create: true
    annotations: { }
    name: ""
  ## Pod annotations for addressing pods
  podAnnotations: { }
  ## The security context for the addressing Pods
  ## - spec for PodSecurityContext:
  ##   https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#podsecuritycontext-v1-core
  ##
  podSecurityContext: { }
  securityContext: { }
  ## The toleration configs for the addressing pods
  ## - spec for Toleration:
  ##   https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#toleration-v1-core
  ##
  tolerations: [ ]
  ## The affinity configs for the addressing pods
  ## - spec for Affinity:
  ##    https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#affinity-v1-core
  ##
  affinity: { }
  ##
  ## Autoscaling configs
  ## By default, minimum replicas are set to 1 and maximum to 10
  ## You can override this parameter as follows:
  # --set "addressing-svc.autoscaling.minReplicas=10"
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 20
    targetCPUUtilizationPercentage: 70
  ##
  ## Country-specific configurations for addressing pods of the `verify-geocode` capability.
  ## You can specify country-specific configurations, such as resource requests, nodeSelector, and thread pool sizes.
  ## Follow the table below for country-specific recommendations:
  ##
  ## #########################################
  ## COUNTRY   Recommended CPU, Memory Requests
  ## #########################################
  ##  USA       1000m, 8Gi
  ##  AUS       1000m, 6Gi
  ##  CAN       1000m, 6Gi
  ##  GBR       1000m, 6Gi
  ##  DEU       1000m, 6Gi
  ##  NZL       1000m, 10Gi
  ##  FRA       1000m, 7Gi
  ##
  ## [NOTE]: These configurations are recommended after testing scenarios in a production environment for the Geo-Addressing application.
  ##
  ## If a country-specific configuration is not provided, the default configurations will be used.
  ## For example, to provide configurations related to [CAN], use the following block or configurations like [USA]:
  ##
  ##  can:
  ##      resources:
  ##        requests:
  ##          cpu: 1000m
  ##          memory: 6Gi
  ##      nodeSelector: {}
  ##
  ## You can also set the parameters for a country in the Helm chart like this:
  ##
  ##  --set "addressing-svc.countryConfigurations.can.resources.requests.cpu=1000m"
  ##  --set "addressing-svc.countryConfigurations.can.resources.requests.memory=6Gi"
  ##  --set "addressing-svc.countryConfigurations.can.nodeSelector.node-app=geo-addressing"
  countryConfigurations:
    default:
      resources:
        requests:
          cpu: 1
          memory: 8Gi
        limits:
          memory: 8Gi
    usa:
      resources:
        requests:
          cpu: 1
          memory: 8Gi
        limits:
          memory: 8Gi

###################################
## CONFIG | Autocomplete Functionalities
###################################
##
## config related to autocomplete-svc helm chart.
## this helm chart is required if you want to enable autocomplete capabilities in your addressing infrastructure.
autocomplete-svc:
  ## config for enabling or disabling `autocomplete` capabilities.
  enabled: false
  ## number of replicas for autocomplete pods.
  replicaCount: 1
  imagePullSecrets: [ ]
  ## service account will be created by default for autocomplete deployment.
  serviceAccount:
    create: true
    annotations: { }
    name: ""
  ## pod annotations for autocomplete pods
  podAnnotations: { }
  ## the security context for the autocomplete Pods
  ## - spec for PodSecurityContext:
  ##   https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#podsecuritycontext-v1-core
  ##
  podSecurityContext: { }
  securityContext: { }
  ## the toleration configs for the autocomplete pods
  ## - spec for Toleration:
  ##   https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#toleration-v1-core
  ##
  tolerations: [ ]
  ## the affinity configs for the autocomplete pods
  ## - spec for Affinity:
  ##    https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#affinity-v1-core
  ##
  affinity: { }
  ##
  ## Autoscaling configs
  ## By default, minimum replicas are set to 1 and maximum to 10
  ## You can override this parameter as follows:
  # --set "autocomplete-svc.autoscaling.minReplicas=10"
  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 20
    targetCPUUtilizationPercentage: 70
  ##
  ## Country-specific configurations for autocomplete pods of the `autocomplete` capability.
  ## You can specify country-specific configurations, such as resource requests, nodeSelector, and thread pool sizes.
  ## Follow the table below for country-specific recommendations:
  ##
  ## #########################################
  ## COUNTRY   Recommended CPU, Memory Requests
  ## #########################################
  ##  USA       1000m, 6Gi
  ##  AUS       1000m, 8Gi
  ##  CAN       1000m, 4Gi
  ##  GBR       1000m, 6Gi
  ##  DEU       1000m, 6Gi
  ##  NZL       1000m, 8Gi
  ##  FRA       1000m, 6Gi
  ##
  ## [NOTE]: These configurations are recommended after testing scenarios in a production environment for the Geo-Addressing application.
  ##
  ## If a country-specific configuration is not provided, the default configurations will be used.
  ## For example, to provide configurations related to [CAN], use the following block or configurations like [USA]:
  ##
  ##  can:
  ##      resources:
  ##        requests:
  ##          cpu: 1000m
  ##          memory: 6Gi
  ##      nodeSelector: {}
  ##
  ## You can also set the parameters for a country in the Helm chart like this:
  ##
  ##  --set "autocomplete-svc.countryConfigurations.can.resources.requests.cpu=1000m"
  ##  --set "autocomplete-svc.countryConfigurations.can.resources.requests.memory=6Gi"
  ##  --set "autocomplete-svc.countryConfigurations.can.nodeSelector.node-app=geo-addressing"
  ##
  countryConfigurations:
    default:
      resources:
        requests:
          cpu: 1
          memory: 6Gi
        limits:
          memory: 6Gi
    usa:
      resources:
        requests:
          cpu: 1
          memory: 6Gi
        limits:
          memory: 6Gi

###################################
## CONFIG | Look Functionalities
###################################
##
## config related to lookup-svc helm chart.
## this helm chart is required if you want to enable lookup capabilities in your addressing infrastructure.
lookup-svc:
  ## config for enabling or disabling `lookup` capabilities.
  enabled: false
  ## number of replicas for lookup pods.
  replicaCount: 1
  imagePullSecrets: [ ]
  ## service account will be created by default for lookup deployment.
  serviceAccount:
    create: true
    annotations: { }
    name: ""
  ## pod annotations for lookup pods
  podAnnotations: { }
  ## the security context for the lookup Pods
  ## - spec for PodSecurityContext:
  ##   https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#podsecuritycontext-v1-core
  ##
  podSecurityContext: { }
  securityContext: { }
  ## the toleration configs for the lookup pods
  ## - spec for Toleration:
  ##   https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#toleration-v1-core
  ##
  tolerations: [ ]
  ## the affinity configs for the lookup pods
  ## - spec for Affinity:
  ##    https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#affinity-v1-core
  ##
  affinity: { }
  ##
  ## Autoscaling configs
  ## By default, minimum replicas are set to 1 and maximum to 10
  ## You can override this parameter as follows:
  # --set "lookup-svc.autoscaling.minReplicas=10"
  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 20
    targetCPUUtilizationPercentage: 70
  ##
  ## Country-specific configurations for lookup pods of the `lookup` capability.
  ## You can specify country-specific configurations, such as resource requests, nodeSelector, and thread pool sizes.
  ## Follow the table below for country-specific recommendations:
  ##
  ## #########################################
  ## COUNTRY   Recommended CPU, Memory Requests
  ## #########################################
  ##  USA       1000m, 6Gi
  ##  AUS       1000m, 6Gi
  ##  CAN       1000m, 6Gi
  ##  GBR       1000m, 6Gi
  ##  DEU       1000m, 6Gi
  ##  NZL       1000m, 6Gi
  ##  FRA       1000m, 6Gi
  ##
  ## [NOTE]: These configurations are recommended after testing scenarios in a production environment for the Geo-Addressing application.
  ##
  ## If a country-specific configuration is not provided, the default configurations will be used.
  ## For example, to provide configurations related to [CAN], use the following block or configurations like [USA]:
  ##
  ##  can:
  ##      resources:
  ##        requests:
  ##          cpu: 1000m
  ##          memory: 6Gi
  ##      nodeSelector: {}
  ##
  ## You can also set the parameters for a country in the Helm chart like this:
  ##
  ##  --set "lookup-svc.countryConfigurations.can.resources.requests.cpu=1000m"
  ##  --set "lookup-svc.countryConfigurations.can.resources.requests.memory=6Gi"
  ##  --set "lookup-svc.countryConfigurations.can.nodeSelector.node-app=geo-addressing"
  ##
  countryConfigurations:
    default:
      resources:
        requests:
          cpu: 1
          memory: 6Gi
        limits:
          memory: 6Gi
    usa:
      resources:
        requests:
          cpu: 1
          memory: 6Gi
        limits:
          memory: 6Gi


###################################
## CONFIG | Reverse-Geocode Functionalities
###################################
##
## config related to reverse-svc helm chart.
## this helm chart is required if you want to enable reverse-geocode capabilities in your addressing infrastructure.
reverse-svc:
  ## config for enabling or disabling `reverse-geocode` capabilities.
  enabled: false
  ## number of replicas for reverse-geocode pods.
  replicaCount: 1
  imagePullSecrets: [ ]
  ## service account will be created by default for reverse-geocode deployment.
  serviceAccount:
    create: true
    annotations: { }
    name: ""
  ## pod annotations for reverse-geocode pods
  podAnnotations: { }
  ## the security context for the reverse-geocode Pods
  ## - spec for PodSecurityContext:
  ##   https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#podsecuritycontext-v1-core
  ##
  podSecurityContext: { }
  securityContext: { }
  ## the toleration configs for the reverse-geocode pods
  ## - spec for Toleration:
  ##   https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#toleration-v1-core
  ##
  tolerations: [ ]
  ## the affinity configs for the reverse-geocode pods
  ## - spec for Affinity:
  ##    https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#affinity-v1-core
  ##
  affinity: { }
  ##
  ## Autoscaling configs
  ## By default, minimum replicas are set to 1 and maximum to 10
  ## You can override this parameter as follows:
  # --set "reverse-svc.autoscaling.minReplicas=10"
  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 20
    targetCPUUtilizationPercentage: 70
  ##
  ## Country-specific configurations for reverse-geocode pods of the `reverse-geocode` capability.
  ## You can specify country-specific configurations, such as resource requests, nodeSelector, and thread pool sizes.
  ## Follow the table below for country-specific recommendations:
  ##
  ## #########################################
  ## COUNTRY   Recommended CPU, Memory Requests
  ## #########################################
  ##  USA       1000m, 8Gi
  ##  AUS       1000m, 6Gi
  ##  CAN       1000m, 6Gi
  ##  GBR       1000m, 6Gi
  ##  DEU       1000m, 6Gi
  ##  NZL       1000m, 10Gi
  ##  FRA       1000m, 7Gi
  ##
  ## [NOTE]: These configurations are recommended after testing scenarios in a production environment for the Geo-Addressing application.
  ##
  ## If a country-specific configuration is not provided, the default configurations will be used.
  ## For example, to provide configurations related to [CAN], use the following block or configurations like [USA]:
  ##
  ##  can:
  ##      resources:
  ##        requests:
  ##          cpu: 1000m
  ##          memory: 6Gi
  ##      nodeSelector: {}
  ##
  ## You can also set the parameters for a country in the Helm chart like this:
  ##
  ##  --set "reverse-svc.countryConfigurations.can.resources.requests.cpu=1000m"
  ##  --set "reverse-svc.countryConfigurations.can.resources.requests.memory=6Gi"
  ##  --set "reverse-svc.countryConfigurations.can.nodeSelector.node-app=geo-addressing"
  countryConfigurations:
    default:
      resources:
        requests:
          cpu: 1
          memory: 8Gi
        limits:
          memory: 8Gi
    usa:
      resources:
        requests:
          cpu: 1
          memory: 8Gi
        limits:
          memory: 8Gi